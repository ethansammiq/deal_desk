  // Financial calculation helper functions for the Financial Summary table
  
  // Get previous year values
  const getPreviousYearValue = (): number => {
    const advertiserName = getTypedValue("advertiserName") as string;
    const agencyName = getTypedValue("agencyName") as string;
    
    if (salesChannel === "client_direct" && advertiserName) {
      const advertiser = advertisers.find(a => a.name === advertiserName);
      return advertiser?.previousYearRevenue || 850000; // Default value as fallback
    } else if ((salesChannel === "holding_company" || salesChannel === "independent_agency") && agencyName) {
      const agency = agencies.find(a => a.name === agencyName);
      return agency?.previousYearRevenue || 850000; // Default value as fallback
    }
    
    return 850000; // Default value as fallback
  };
  
  // Get previous year gross profit
  const getPreviousYearGrossProfit = (): number => {
    const previousValue = getPreviousYearValue();
--
                {/* Financial Summary Table - Calculated values for each tier */}
                <div className="mt-8 mb-6 bg-white p-6 rounded-lg border border-slate-200 shadow-sm">
                  <h3 className="text-lg font-semibold text-slate-900 mb-4 pb-2 border-b border-slate-100 bg-gradient-to-r from-purple-700 to-indigo-500 bg-clip-text text-transparent">
                    Financial Summary (Automatic Calculations)
                  </h3>
                  
                  <div className="overflow-x-auto">
                    <table className="w-full border-collapse">
                      <thead>
                        <tr>
                          <th className="text-left p-3 bg-slate-100 border border-slate-200 w-1/3">Financial Metric</th>
                          <th className="text-center p-3 bg-slate-100 border border-slate-200">Last Year</th>
                          {dealTiers.map(tier => (
                            <th key={tier.tierNumber} className="text-center p-3 bg-slate-100 border border-slate-200">
                              Tier {tier.tierNumber}
                            </th>
                          ))}
                        </tr>
                      </thead>
                      <tbody>
                        {/* Total Incentive Cost */}
                        <tr>
                          <td className="p-3 border border-slate-200 bg-slate-50">
                            <div className="font-medium">Total Incentive Cost</div>
--
                      {/* Financial Summary Table */}
                      {dealTiers.length > 0 && (
                        <div>
                          <div className="overflow-x-auto">
                            <table className="w-full border-collapse text-sm">
                              <thead>
                                <tr>
                                  <th className="text-left p-2 bg-slate-100 border border-slate-200"></th>
                                  <th className="text-left p-2 bg-slate-100 border border-slate-200">Last Year</th>
                                  {dealTiers.filter(tier => tier.annualRevenue).map(tier => (
                                    <th key={tier.tierNumber} className="text-left p-2 bg-slate-100 border border-slate-200">
                                      Tier {tier.tierNumber}
                                    </th>
                                  ))}
                                </tr>
                              </thead>
                              <tbody>
                                {/* Annual Revenue */}
                                <tr>
                                  <td className="p-2 border border-slate-200 font-medium">Annual Revenue</td>
                                  <td className="p-2 border border-slate-200">
